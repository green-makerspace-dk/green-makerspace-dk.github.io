<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js bg-helmets "><!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>Gallery - Green Makerspace</title>
		<meta name="description" content="Photo gallery showcasing Green Makerspace projects and activities">
		<meta name="viewport" content="width=device-width">
		<link rel="stylesheet" href="css/normalize.css">
		<link href="css/css.css" rel="stylesheet" type="text/css">
		<link rel="stylesheet" href="css/main.css">
		<!--[if lt IE 9]>
			<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
			<script>window.html5 || document.write('<script src="js/vendor/html5shiv.js"><\/script>')</script>
		<![endif]-->
		<style>
			.gallery-container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 2em;
			}
			
			.gallery-title {
				text-align: center;
				color: #62a731;
				margin-bottom: 2em;
				font-size: 2.5em;
			}
			
			.gallery-description {
				text-align: center;
				margin-bottom: 3em;
				color: #566473;
				font-size: 1.1em;
				max-width: 600px;
				margin-left: auto;
				margin-right: auto;
			}
			
			.gallery-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 20px;
				margin-bottom: 2em;
			}
			
			.gallery-item {
				position: relative;
				background: #fff;
				border-radius: 10px;
				overflow: hidden;
				box-shadow: 0 4px 15px rgba(0,0,0,0.1);
				transition: all 0.3s ease;
				cursor: pointer;
			}
			
			.gallery-item:hover {
				transform: translateY(-5px);
				box-shadow: 0 8px 25px rgba(0,0,0,0.15);
			}
			
			.gallery-item img {
				width: 100%;
				height: 250px;
				object-fit: cover;
				transition: transform 0.3s ease;
			}
			
			.gallery-item:hover img {
				transform: scale(1.05);
			}
			
			.gallery-item-overlay {
				position: absolute;
				bottom: 0;
				left: 0;
				right: 0;
				background: linear-gradient(transparent, rgba(0,0,0,0.7));
				color: white;
				padding: 20px;
				transform: translateY(100%);
				transition: transform 0.3s ease;
			}
			
			.gallery-item:hover .gallery-item-overlay {
				transform: translateY(0);
			}
			
			.gallery-item-title {
				font-weight: bold;
				margin-bottom: 5px;
			}
			
			.gallery-item-description {
				font-size: 0.9em;
				opacity: 0.9;
			}
			
			/* Lightbox Modal */
			.lightbox {
				display: none;
				position: fixed;
				z-index: 1000;
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0,0,0,0.9);
				animation: fadeIn 0.3s ease;
			}
			
			.lightbox-content {
				position: relative;
				margin: auto;
				padding: 20px;
				width: 90%;
				max-width: 800px;
				top: 50%;
				transform: translateY(-50%);
				text-align: center;
			}
			
			.lightbox img {
				max-width: 100%;
				max-height: 80vh;
				border-radius: 10px;
				box-shadow: 0 4px 20px rgba(0,0,0,0.3);
			}
			
			.lightbox-close {
				position: absolute;
				top: 15px;
				right: 35px;
				color: #fff;
				font-size: 40px;
				font-weight: bold;
				cursor: pointer;
				transition: color 0.3s ease;
			}
			
			.lightbox-close:hover {
				color: #79c843;
			}
			
			.lightbox-caption {
				color: white;
				text-align: center;
				margin-top: 15px;
				font-size: 1.1em;
			}
			
			.lightbox-nav {
				position: absolute;
				top: 50%;
				transform: translateY(-50%);
				color: white;
				font-size: 30px;
				font-weight: bold;
				cursor: pointer;
				padding: 10px;
				user-select: none;
				transition: color 0.3s ease;
			}
			
			.lightbox-nav:hover {
				color: #79c843;
			}
			
			.lightbox-prev {
				left: 20px;
			}
			
			.lightbox-next {
				right: 20px;
			}
			
			.no-images-message {
				text-align: center;
				padding: 4em 2em;
				background: #f8f9fa;
				border-radius: 10px;
				margin: 2em 0;
			}
			
			.no-images-message h3 {
				color: #62a731;
				margin-bottom: 1em;
			}
			
			.no-images-message p {
				color: #566473;
				margin-bottom: 1em;
			}
			
			.upload-info {
				background: #e8f5e8;
				padding: 1em;
				border-radius: 5px;
				border-left: 4px solid #79c843;
				font-size: 0.9em;
				color: #2d5016;
			}
			
			@keyframes fadeIn {
				from { opacity: 0; }
				to { opacity: 1; }
			}
			
			/* Responsive Design */
			@media screen and (max-width: 768px) {
				.gallery-grid {
					grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
					gap: 15px;
				}
				
				.gallery-item img {
					height: 200px;
				}
				
				.lightbox-nav {
					font-size: 24px;
				}
				
				.lightbox-close {
					font-size: 30px;
					top: 10px;
					right: 20px;
				}
			}
			
			@media screen and (max-width: 480px) {
				.gallery-container {
					padding: 1em;
				}
				
				.gallery-grid {
					grid-template-columns: 1fr;
				}
				
				.gallery-title {
					font-size: 2em;
				}
			}
		</style>
	</head>
	<body>
		<!--[if lt IE 7]>
			<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
		<![endif]-->
		<header class="site-header">
			<div class="header-container">
				<a href="/" class="header-logo-link">
					<img src="images/logo.svg" alt="Green Makerspace" class="header-logo-img">
					<span class="header-title">Green Makerspace</span>
				</a>
				<nav class="main-nav">
					<a href="/about" class="nav-link">About Us</a>
					<a href="/calculator" class="nav-link">Calculator</a>
					<a href="/gallery" class="nav-link active">Gallery</a>
					<a href="/become-member" class="nav-link btn-cta">Become a member</a>
				</nav>
			</div>
		</header>

		<main class="frame">
			<div class="gallery-container">
				<h1 class="gallery-title">Project Gallery</h1>
				<p class="gallery-description">
					Explore our collection of innovative projects, workshops, and creative endeavors 
					from the Green Makerspace community. From sustainable technology to artistic creations, 
					see what our makers have been building.
				</p>
				
				<div id="gallery-grid" class="gallery-grid">
					<!-- Gallery items will be dynamically loaded here -->
				</div>
				
				<div id="no-images" class="no-images-message" style="display: none;">
					<h3>Gallery Coming Soon!</h3>
					<p>We're currently setting up our project gallery. Check back soon to see amazing projects from our Green Makerspace community.</p>
					<div class="upload-info">
						<strong>For administrators:</strong> Add images to the <code>/gallery/</code> folder to populate this gallery automatically.
						Supported formats: JPG, PNG, GIF, WebP
					</div>
				</div>
			</div>
		</main>

		<!-- Lightbox Modal -->
		<div id="lightbox" class="lightbox">
			<div class="lightbox-content">
				<span class="lightbox-close" onclick="closeLightbox()">&times;</span>
				<span class="lightbox-nav lightbox-prev" onclick="changeImage(-1)">&#10094;</span>
				<span class="lightbox-nav lightbox-next" onclick="changeImage(1)">&#10095;</span>
				<img id="lightbox-img" src="" alt="">
				<div id="lightbox-caption" class="lightbox-caption"></div>
			</div>
		</div>

		<script>
			let currentImageIndex = 0;

			// Common image file extensions
			const imageExtensions = ['jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp', 'svg'];
			
			// Function to load images from gallery folder
			async function loadGalleryImages() {
				try {
					// Try to load gallery data from auto-generated JSON file
					const response = await fetch('gallery/gallery-data.json');
					if (response.ok) {
						const galleryInfo = await response.json();
						galleryImages = galleryInfo.images || [];
						console.log(`Loaded ${galleryImages.length} images from gallery-data.json`);
					} else {
						// Use the auto-generated gallery data embedded in this file
						console.log(`Using embedded gallery data: ${galleryImages.length} images`);
					}
					
					displayGallery();
				} catch (error) {
					console.log('Using embedded gallery data as fallback');
					// galleryImages is already defined above with the auto-generated data
					displayGallery();
				}
			}

			// Function to display gallery images
			function displayGallery() {
				console.log('displayGallery called with', galleryImages.length, 'images');
				const galleryGrid = document.getElementById('gallery-grid');
				const noImagesMessage = document.getElementById('no-images');
				
				if (!galleryGrid) {
					console.error('Gallery grid element not found!');
					return;
				}
				
				if (galleryImages.length === 0) {
					console.log('No images to display, showing no-images message');
					galleryGrid.style.display = 'none';
					noImagesMessage.style.display = 'block';
					return;
				}
				
				console.log('Displaying', galleryImages.length, 'images');
				galleryGrid.style.display = 'grid';
				noImagesMessage.style.display = 'none';
				
				galleryGrid.innerHTML = '';
				
				galleryImages.forEach((image, index) => {
					console.log('Creating gallery item for:', image.title, 'src:', image.src);
					const galleryItem = document.createElement('div');
					galleryItem.className = 'gallery-item';
					galleryItem.onclick = () => openLightbox(index);
					
					galleryItem.innerHTML = `
						<img src="${image.src}" alt="${image.title}" loading="lazy" onerror="console.error('Failed to load image:', this.src)">
						<div class="gallery-item-overlay">
							<div class="gallery-item-title">${image.title}</div>
							<div class="gallery-item-description">${image.description}</div>
						</div>
					`;
					
					galleryGrid.appendChild(galleryItem);
				});
				
				console.log('Gallery display completed');
			}

			// Lightbox functions
			function openLightbox(index) {
				currentImageIndex = index;
				const lightbox = document.getElementById('lightbox');
				const lightboxImg = document.getElementById('lightbox-img');
				const lightboxCaption = document.getElementById('lightbox-caption');
				
				lightboxImg.src = galleryImages[index].src;
				lightboxCaption.innerHTML = `
					<strong>${galleryImages[index].title}</strong><br>
					${galleryImages[index].description}
				`;
				
				lightbox.style.display = 'block';
				document.body.style.overflow = 'hidden';
			}

			function closeLightbox() {
				const lightbox = document.getElementById('lightbox');
				lightbox.style.display = 'none';
				document.body.style.overflow = 'auto';
			}

			function changeImage(direction) {
				currentImageIndex += direction;
				
				if (currentImageIndex >= galleryImages.length) {
					currentImageIndex = 0;
				} else if (currentImageIndex < 0) {
					currentImageIndex = galleryImages.length - 1;
				}
				
				const lightboxImg = document.getElementById('lightbox-img');
				const lightboxCaption = document.getElementById('lightbox-caption');
				
				lightboxImg.src = galleryImages[currentImageIndex].src;
				lightboxCaption.innerHTML = `
					<strong>${galleryImages[currentImageIndex].title}</strong><br>
					${galleryImages[currentImageIndex].description}
				`;
			}

			// Keyboard navigation
			document.addEventListener('keydown', function(event) {
				const lightbox = document.getElementById('lightbox');
				if (lightbox.style.display === 'block') {
					switch(event.key) {
						case 'Escape':
							closeLightbox();
							break;
						case 'ArrowLeft':
							changeImage(-1);
							break;
						case 'ArrowRight':
							changeImage(1);
							break;
					}
				}
			});

			// Close lightbox when clicking outside image
			document.getElementById('lightbox').addEventListener('click', function(event) {
				if (event.target === this) {
					closeLightbox();
				}
			});

			// Load gallery on page load
			document.addEventListener('DOMContentLoaded', loadGalleryImages);
		</script>
	</body>
</html>
